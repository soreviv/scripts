# snippets/security_headers.conf
# Un conjunto de cabeceras de seguridad modernas y robustas para Nginx.

# Obliga a los navegadores a usar HTTPS durante los próximos 6 meses.
add_header Strict-Transport-Security "max-age=15768000; includeSubDomains; preload" always;

# Evita que el sitio sea incrustado en iframes en otros dominios (previene clickjacking).
add_header X-Frame-Options "SAMEORIGIN" always;

# Previene que el navegador "adivine" el tipo de contenido (MIME-sniffing).
add_header X-Content-Type-Options "nosniff" always;

# Controla qué información de "referencia" se incluye en las solicitudes.
add_header Referrer-Policy "strict-origin-when-cross-origin" always;

# Controla qué características del navegador se pueden usar en el sitio.
add_header Permissions-Policy "geolocation=(), microphone=(), camera=()" always;

# Elimina la cabecera "Server" para no revelar la versión de Nginx.
server_tokens off;

# --- Content-Security-Policy (CSP) ---
# Esta es la cabecera de seguridad más importante contra ataques XSS.
# Sin embargo, es MUY específica para cada sitio web.
#
# DESCOMENTA Y ADAPTA la siguiente línea según las necesidades de tu sitio.
#
# Ejemplo: Política estricta que solo permite recursos del propio dominio.
# add_header Content-Security-Policy "default-src 'self'; script-src 'self'; style-src 'self'; img-src 'self'; font-src 'self'; object-src 'none'; frame-ancestors 'none';" always;
#
# Para sitios más complejos con CDNs o servicios de terceros, necesitarás añadir
# sus dominios a las directivas correspondientes. Por ejemplo:
# add_header Content-Security-Policy "default-src 'self'; script-src 'self' https://cdn.ejemplo.com; style-src 'self' https://fonts.googleapis.com; img-src 'self' data:;" always;
